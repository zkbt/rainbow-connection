<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>rainbowconnection.atmospheres.sunset &#8212; rainbow-connection 0.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for rainbowconnection.atmospheres.sunset</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">..imports</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">..sources</span> <span class="k">import</span> <span class="n">Spectrum</span>
<span class="kn">from</span> <span class="nn">..animatetools</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.sky</span> <span class="k">import</span> <span class="o">*</span>

<div class="viewcode-block" id="Sunset"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset">[docs]</a><span class="k">class</span> <span class="nc">Sunset</span><span class="p">(</span><span class="n">Spectrum</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">atmosphere</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialize this composite object, connecting a light source</span>
<span class="sd">        and an atmosphere together into a Sunset calculator.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        source : rainbowconnection.Spectrum</span>
<span class="sd">            The light source from above the atmosphere.</span>
<span class="sd">        atmosphere : rainbowconnection.Atmosphere</span>
<span class="sd">            The atmosphere through which the light source propagates.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atmosphere</span> <span class="o">=</span> <span class="n">atmosphere</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky</span> <span class="o">=</span> <span class="n">Sky</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># KLUDGE - there&#39;s got to be a better way to organize this?!</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">radius</span>

    <span class="c1"># KLUDGE - there&#39;s got to be a better way to organize this?!</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">distance</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        How should this be represented as a string?</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">s</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atmosphere</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{s}</span><span class="se">\n</span><span class="s1"> through</span><span class="se">\n</span><span class="si">{t}</span><span class="s1">&#39;</span>

<div class="viewcode-block" id="Sunset.set_zenith_angle"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.set_zenith_angle">[docs]</a>    <span class="k">def</span> <span class="nf">set_zenith_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Pass zenith commands up to the atmosphere.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atmosphere</span><span class="o">.</span><span class="n">set_zenith_angle</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sunset.set_altiude"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.set_altiude">[docs]</a>    <span class="k">def</span> <span class="nf">set_altiude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Pass altitude commands up to the atmosphere.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atmosphere</span><span class="o">.</span><span class="n">set_altitude</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sunset.spectrum"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zenith_angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The spectrum of the light source viewed through the atmosphere.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength : astropy.units.quantity.Quantity</span>
<span class="sd">            The wavelengths on which we want the spectrum.</span>

<span class="sd">        zenith_angle : astropy.units.quantity.Quantity</span>
<span class="sd">            The angle away from zenith along which</span>
<span class="sd">            the transmission of the atmosphere should</span>
<span class="sd">            be calculated.</span>

<span class="sd">        altitude : float</span>
<span class="sd">            The altitude at which we should be floating</span>
<span class="sd">            in the atmosphere, in units of scale heights.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        spectrum : astropy.units.quantity.Quantity</span>
<span class="sd">            The luminosity (W/nm) or flux (W/nm/m**2).</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># the transmission wavelength sets the grid</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmosphere</span><span class="o">.</span><span class="n">wavelength</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>

        <span class="c1"># get the transmission a</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmosphere</span><span class="o">.</span><span class="n">transmission</span><span class="p">(</span><span class="n">wavelength</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
                                         <span class="n">zenith_angle</span><span class="o">=</span><span class="n">zenith_angle</span><span class="p">,</span>
                                         <span class="n">altitude</span><span class="o">=</span><span class="n">altitude</span><span class="p">)</span>

        <span class="c1"># get the original spectrum</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>

        <span class="c1"># return the transmitted spectrum</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">*</span><span class="n">t</span></div>




<div class="viewcode-block" id="Sunset.plot_disk"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.plot_disk">[docs]</a>    <span class="k">def</span> <span class="nf">plot_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zenith_angle</span><span class="o">=</span><span class="mi">89</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">azimuth_angle</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot the disk of the star.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : matplotlib.axes._subplots.AxesSubplot</span>
<span class="sd">            The axes into which this plot should be drawn.</span>
<span class="sd">        zenith_angle : astropy.units.quantity.Quantity</span>
<span class="sd">            The angle away from zenith.</span>
<span class="sd">        azimuth_angle : astropy.units.quantity.Quantity</span>
<span class="sd">            The azimuth angle along the horizon.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">),</span> <span class="n">quantity_support</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

            <span class="c1"># set the zenith angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_zenith_angle</span><span class="p">(</span><span class="n">zenith_angle</span><span class="p">)</span>

            <span class="c1"># figure out the color of the star</span>
            <span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_color</span><span class="p">()</span>

            <span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="n">azimuth_angle</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">zenith_angle</span><span class="p">],</span>
                           <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">angular_size</span><span class="p">(),</span>
                           <span class="n">facecolor</span><span class="o">=</span><span class="n">rgb</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">angular_size</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">azimuth_angle</span> <span class="o">-</span> <span class="n">size</span><span class="p">,</span> <span class="n">azimuth_angle</span> <span class="o">+</span> <span class="n">size</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">zenith_angle</span> <span class="o">-</span> <span class="n">size</span><span class="p">,</span>
                     <span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">zenith_angle</span> <span class="o">+</span> <span class="n">size</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">c</span></div>

<div class="viewcode-block" id="Sunset.plot_sky"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.plot_sky">[docs]</a>    <span class="k">def</span> <span class="nf">plot_sky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxelevation</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                       <span class="n">minelevation</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                       <span class="n">skyresolution</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                       <span class="n">skynormalization</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot a diffuse sky behind the disk of the star.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maxelevation : astropy.units.quantity.Quantity</span>
<span class="sd">            The maximum elevation above the horizon.</span>
<span class="sd">        minelevation : astropy.units.quantity.Quantity</span>
<span class="sd">            The minimum elevation above the horizon.</span>
<span class="sd">        skyresolution : astropy.units.quantity.Quantity</span>
<span class="sd">            The vertical extent of constant-color stripes</span>
<span class="sd">            when rendering the atmosphere. Stripes larger</span>
<span class="sd">            than ~1/20 the vertical extent will be very</span>
<span class="sd">            noticeable.</span>
<span class="sd">        skynormalization : float</span>
<span class="sd">            By what factor do we down-weight the intensity</span>
<span class="sd">            of the sky. To be quantitatively correct, this</span>
<span class="sd">            should be something like the ratio of the</span>
<span class="sd">            stellar disk intensity to the diffuse sky</span>
<span class="sd">            brightness, but that factor is so tiny that</span>
<span class="sd">            the sky would always seem to be black.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmosphere</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">==</span> <span class="s1">&#39;NoAtmosphere&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># set the elevations where we will calculate sky colors</span>
        <span class="n">elevations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">minelevation</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                               <span class="p">(</span><span class="n">maxelevation</span> <span class="o">+</span> <span class="n">skyresolution</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                               <span class="n">skyresolution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span>

        <span class="c1"># calculate a list of sky colors, one for each elevation</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elevations</span><span class="p">:</span>

            <span class="c1"># point at a particular stripe of the sky</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sky</span><span class="o">.</span><span class="n">set_zenith_angle</span><span class="p">(</span><span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span>

            <span class="c1"># estimate the color of that stripe</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky</span><span class="o">.</span><span class="n">to_color</span><span class="p">()</span><span class="o">*</span><span class="n">skynormalization</span><span class="p">)</span>

        <span class="c1"># draw horizontal bars with these colors</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">elevations</span><span class="p">,</span>
                 <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">height</span><span class="o">=</span><span class="n">skyresolution</span><span class="p">,</span>
                 <span class="n">left</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sunset.plot_sunset"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.plot_sunset">[docs]</a>    <span class="k">def</span> <span class="nf">plot_sunset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">zenith_angle</span><span class="o">=</span><span class="mi">89</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                          <span class="n">azimuth_angle</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                          <span class="n">maxelevation</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                          <span class="n">minelevation</span><span class="o">=-</span><span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                          <span class="n">skyresolution</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                          <span class="n">skynormalization</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot the disk of the star and the diffuse sky.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : matplotlib.axes._subplots.AxesSubplot</span>
<span class="sd">            The axes into which this plot should be drawn.</span>
<span class="sd">        zenith_angle : astropy.units.quantity.Quantity</span>
<span class="sd">            The angle away from zenith.</span>
<span class="sd">        azimuth_angle : astropy.units.quantity.Quantity</span>
<span class="sd">            The azimuth angle along the horizon.</span>
<span class="sd">        maxelevation : astropy.units.quantity.Quantity</span>
<span class="sd">            The maximum elevation above the horizon.</span>
<span class="sd">        minelevation : astropy.units.quantity.Quantity</span>
<span class="sd">            The minimum elevation above the horizon.</span>
<span class="sd">        skyresolution : astropy.units.quantity.Quantity</span>
<span class="sd">            The vertical extent of constant-color stripes</span>
<span class="sd">            when rendering the atmosphere. Stripes larger</span>
<span class="sd">            than ~1/20 the vertical extent will be very</span>
<span class="sd">            noticeable.</span>
<span class="sd">        skynormalization : float</span>
<span class="sd">            By what factor do we down-weight the intensity</span>
<span class="sd">            of the sky. To be quantitatively correct, this</span>
<span class="sd">            should be something like the ratio of the</span>
<span class="sd">            stellar disk intensity to the diffuse sky</span>
<span class="sd">            brightness, but that factor is so tiny that</span>
<span class="sd">            the sky would always seem to be black.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># make sure we&#39;re using a dark background and astropy units</span>
        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">),</span> <span class="n">quantity_support</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

            <span class="c1"># put the sun at a particular elevation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_zenith_angle</span><span class="p">(</span><span class="n">zenith_angle</span><span class="p">)</span>

            <span class="c1"># plot the diffuse sky</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_sky</span><span class="p">(</span><span class="n">maxelevation</span><span class="o">=</span><span class="n">maxelevation</span><span class="p">,</span>
                          <span class="n">minelevation</span><span class="o">=</span><span class="n">minelevation</span><span class="p">)</span>

            <span class="c1"># plot the disk of the sun</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_disk</span><span class="p">(</span><span class="n">zenith_angle</span><span class="o">=</span><span class="n">zenith_angle</span><span class="p">,</span>
                           <span class="n">azimuth_angle</span><span class="o">=</span><span class="n">azimuth_angle</span><span class="p">)</span>

            <span class="c1"># fuss with the axis labels</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">maxelevation</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Angle above Horizon&#39;</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="Sunset.animate_sunset"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.animate_sunset">[docs]</a>    <span class="k">def</span> <span class="nf">animate_sunset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;sunset.mp4&#39;</span><span class="p">,</span>
                             <span class="n">maxelevation</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                             <span class="n">skyresolution</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                             <span class="n">skynormalization</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                             <span class="n">motionresolution</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Animate the sun setting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : string</span>
<span class="sd">            The filename where this animation should be saved</span>
<span class="sd">        maxelevation : astropy.units.quantity.Quantity</span>
<span class="sd">            The maximum elevation above the horizon.</span>
<span class="sd">        skyresolution : astropy.units.quantity.Quantity</span>
<span class="sd">            The vertical extent of constant-color stripes</span>
<span class="sd">            when rendering the atmosphere. Stripes larger</span>
<span class="sd">            than ~1/20 the vertical extent will be very</span>
<span class="sd">            noticeable.</span>
<span class="sd">        skynormalization : float</span>
<span class="sd">            By what factor do we down-weight the intensity</span>
<span class="sd">            of the sky. To be quantitatively correct, this</span>
<span class="sd">            should be something like the ratio of the</span>
<span class="sd">            stellar disk intensity to the diffuse sky</span>
<span class="sd">            brightness, but that factor is so tiny that</span>
<span class="sd">            the sky would always seem to be black.</span>
<span class="sd">        motionresolution : astropy.units.quantity.Quantity</span>
<span class="sd">            The angular step the star moves between</span>
<span class="sd">            frames of the animation.</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="c1"># get the appropriate animation writer</span>
        <span class="n">wri</span> <span class="o">=</span> <span class="n">get_writer</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="c1"># calculate the grid of zenith angles for the star</span>
        <span class="n">min_zenith</span> <span class="o">=</span> <span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">maxelevation</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">angular_size</span><span class="p">()</span>
        <span class="n">minelevation</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">angular_size</span><span class="p">()</span> <span class="o">+</span> <span class="n">motionresolution</span><span class="p">)</span>
        <span class="n">max_zenith</span> <span class="o">=</span> <span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">minelevation</span>
        <span class="n">zenith_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_zenith</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                  <span class="n">max_zenith</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                  <span class="n">motionresolution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span>


        <span class="c1"># make a figure with a dark background</span>
        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">),</span> <span class="n">quantity_support</span><span class="p">():</span>

            <span class="c1"># create a new figure</span>
            <span class="n">fi</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># save to frames of an animation</span>
            <span class="k">with</span> <span class="n">wri</span><span class="o">.</span><span class="n">saving</span><span class="p">(</span><span class="n">fi</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="mi">400</span><span class="p">):</span>

                <span class="c1"># loop over zenith angles</span>
                <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">zenith_angles</span><span class="p">):</span>

                    <span class="c1"># clear whatever was in the previous axes</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

                    <span class="c1"># plot the sunset at this current stellar zenith angle</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_sunset</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                     <span class="n">zenith_angle</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                                     <span class="n">maxelevation</span><span class="o">=</span><span class="n">maxelevation</span><span class="p">,</span>
                                     <span class="n">minelevation</span><span class="o">=</span><span class="n">minelevation</span><span class="p">)</span>

                    <span class="c1"># grab this frame in the animation</span>
                    <span class="n">wri</span><span class="o">.</span><span class="n">grab_frame</span><span class="p">()</span></div>

<div class="viewcode-block" id="Sunset.animate_everything"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.animate_everything">[docs]</a>    <span class="k">def</span> <span class="nf">animate_everything</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;everything-sunset.mp4&#39;</span><span class="p">,</span>
                                 <span class="n">ingredients</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sky&#39;</span><span class="p">,</span> <span class="s1">&#39;sky-zoom&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;spectrum&#39;</span><span class="p">],</span>
                                 <span class="n">maxelevation</span><span class="o">=</span><span class="mi">50</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                                 <span class="n">skyresolution</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                                 <span class="n">skynormalization</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                 <span class="n">motionresolution</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Make an animation that summarizes</span>
<span class="sd">        lots of information about a sunset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : string</span>
<span class="sd">            The filename where this animation should be saved</span>
<span class="sd">        ingredients : list</span>
<span class="sd">            The components to draw. These are:</span>
<span class="sd">                &#39;sky&#39; = a slice of many elevations</span>
<span class="sd">                &#39;sky-zoom&#39; = just the disk of the star</span>
<span class="sd">                &#39;rgb&#39; = a plot of relative RGB colors</span>
<span class="sd">                &#39;spectrum&#39; = a plot of the spectrum</span>
<span class="sd">            Any subset of these is allowed.</span>
<span class="sd">        maxelevation : astropy.units.quantity.Quantity</span>
<span class="sd">            The maximum elevation above the horizon.</span>
<span class="sd">        skyresolution : astropy.units.quantity.Quantity</span>
<span class="sd">            The vertical extent of constant-color stripes</span>
<span class="sd">            when rendering the atmosphere. Stripes larger</span>
<span class="sd">            than ~1/20 the vertical extent will be very</span>
<span class="sd">            noticeable.</span>
<span class="sd">        skynormalization : float</span>
<span class="sd">            By what factor do we down-weight the intensity</span>
<span class="sd">            of the sky. To be quantitatively correct, this</span>
<span class="sd">            should be something like the ratio of the</span>
<span class="sd">            stellar disk intensity to the diffuse sky</span>
<span class="sd">            brightness, but that factor is so tiny that</span>
<span class="sd">            the sky would always seem to be black.</span>
<span class="sd">        motionresolution : astropy.units.quantity.Quantity</span>
<span class="sd">            The angular step the star moves between</span>
<span class="sd">            frames of the animation.</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="c1"># get the appropriate animation writer</span>
        <span class="n">wri</span> <span class="o">=</span> <span class="n">get_writer</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="c1"># calculate the grid of zenith angles for the star</span>
        <span class="n">min_zenith</span> <span class="o">=</span> <span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">maxelevation</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">angular_size</span><span class="p">()</span>
        <span class="n">minelevation</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">angular_size</span><span class="p">()</span> <span class="o">+</span> <span class="n">motionresolution</span><span class="p">)</span>
        <span class="n">max_zenith</span> <span class="o">=</span> <span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">minelevation</span>
        <span class="n">zenith_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_zenith</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                  <span class="n">max_zenith</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                  <span class="n">motionresolution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span>

        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">),</span> <span class="n">quantity_support</span><span class="p">():</span>

            <span class="n">fi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_everything</span><span class="p">(</span><span class="n">zenith_angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># save to frames of an animation</span>
            <span class="k">with</span> <span class="n">wri</span><span class="o">.</span><span class="n">saving</span><span class="p">(</span><span class="n">fi</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="mi">160</span><span class="p">):</span>

                <span class="c1"># loop over zenith angles</span>
                <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">zenith_angles</span><span class="p">):</span>

                    <span class="c1"># clear whatever was in the previous axes</span>
                    <span class="n">fi</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                    <span class="c1"># plot the sunset at this current stellar zenith angle</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_everything</span><span class="p">(</span><span class="n">fi</span><span class="o">=</span><span class="n">fi</span><span class="p">,</span> <span class="n">zenith_angle</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                                         <span class="n">ingredients</span><span class="o">=</span><span class="n">ingredients</span><span class="p">)</span>

                    <span class="c1"># grab this frame in the animation</span>
                    <span class="n">wri</span><span class="o">.</span><span class="n">grab_frame</span><span class="p">()</span></div>


<div class="viewcode-block" id="Sunset.plot_everything"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.plot_everything">[docs]</a>    <span class="k">def</span> <span class="nf">plot_everything</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingredients</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sky&#39;</span><span class="p">,</span> <span class="s1">&#39;sky-zoom&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;spectrum&#39;</span><span class="p">],</span>
                              <span class="n">zenith_angle</span><span class="o">=</span><span class="mi">85</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                              <span class="n">maxelevation</span><span class="o">=</span><span class="mi">50</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                              <span class="n">fi</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Make an animation that summarizes</span>
<span class="sd">        lots of information about a sunset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ingredients : list</span>
<span class="sd">            The components to draw. These are:</span>
<span class="sd">                &#39;sky&#39; = a slice of many elevations</span>
<span class="sd">                &#39;sky-zoom&#39; = just the disk of the star</span>
<span class="sd">                &#39;rgb&#39; = a plot of relative RGB colors</span>
<span class="sd">                &#39;spectrum&#39; = a plot of the spectrum</span>
<span class="sd">            Any subset of these is allowed.</span>
<span class="sd">        zenith_angle : astropy.units.quantity.Quantity</span>
<span class="sd">            The angle away from zenith.</span>
<span class="sd">        maxelevation : astropy.units.quantity.Quantity</span>
<span class="sd">            The maximum elevation above the horizon</span>
<span class="sd">            (for setting the plot limits.)</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">),</span> <span class="n">quantity_support</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">fi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xpixels</span><span class="p">,</span> <span class="n">ypixels</span> <span class="o">=</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mf">6.75</span><span class="p">))</span>
                <span class="n">dpi</span> <span class="o">=</span> <span class="mi">1920</span><span class="o">/</span><span class="mi">12</span> <span class="c1"># 160</span>

            <span class="c1"># set up the basic columns</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
                            <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">],</span>
                            <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># set up the contextualizing plots on the left</span>
            <span class="n">gs_geometry</span> <span class="o">=</span> <span class="n">GridSpecFromSubplotSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                                  <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                                  <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                                  <span class="n">subplot_spec</span><span class="o">=</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1">#ax[&#39;cartoon&#39;] = plt.subplot(gs_geometry[0])</span>
            <span class="k">if</span> <span class="s1">&#39;sky-zoom&#39;</span> <span class="ow">in</span> <span class="n">ingredients</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;sky-zoom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs_geometry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_disk</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="s1">&#39;sky-zoom&#39;</span><span class="p">],</span> <span class="n">zenith_angle</span><span class="o">=</span><span class="n">zenith_angle</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">angular_size</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">zenith_angle</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="o">-</span> <span class="n">zenith_angle</span> <span class="o">+</span> <span class="n">width</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;sky-zoom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;sky-zoom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

            <span class="c1"># set up the main panel showing the sunset over the full sky</span>
            <span class="k">if</span> <span class="s1">&#39;sky&#39;</span> <span class="ow">in</span> <span class="n">ingredients</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;sky&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1"># actually make the plots</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_sunset</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="s1">&#39;sky&#39;</span><span class="p">],</span> <span class="n">zenith_angle</span><span class="o">=</span><span class="n">zenith_angle</span><span class="p">,</span> <span class="n">maxelevation</span><span class="o">=</span><span class="n">maxelevation</span><span class="p">)</span>

            <span class="c1">#</span>
            <span class="c1"># set up the spectrum panels</span>
            <span class="n">gs_spectra</span> <span class="o">=</span> <span class="n">GridSpecFromSubplotSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                                 <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                                 <span class="n">subplot_spec</span><span class="o">=</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                                 <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;rgb&#39;</span> <span class="ow">in</span> <span class="n">ingredients</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;rgb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs_spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_rgb</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="s1">&#39;rgb&#39;</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">360</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">,</span> <span class="mi">740</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;spectrum&#39;</span> <span class="ow">in</span> <span class="n">ingredients</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs_spectra</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                             <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="s1">&#39;rgb&#39;</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="s1">&#39;rgb&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_as_rainbow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">360</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">,</span> <span class="mi">740</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fi</span></div>

<div class="viewcode-block" id="Sunset.plot_rgb"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.plot_rgb">[docs]</a>    <span class="k">def</span> <span class="nf">plot_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Wrapper to add the unextincted spectrum</span>
<span class="sd">        in dark gray in the background for context.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="o">.</span><span class="n">plot_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">plot_rgb</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sunset.plot_as_rainbow"><a class="viewcode-back" href="../../../api.html#rainbowconnection.atmospheres.sunset.Sunset.plot_as_rainbow">[docs]</a>    <span class="k">def</span> <span class="nf">plot_as_rainbow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Wrapper to add the unextincted spectrum</span>
<span class="sd">        in dark gray in the background for context.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="o">.</span><span class="n">plot_as_rainbow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">plot_as_rainbow</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../light-sources.html">Light Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../atmospheres.html">Atmospheres</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sunsets.html">Sunsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Zach Berta-Thompson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>